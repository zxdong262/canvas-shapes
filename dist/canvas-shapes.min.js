/**
 * canvas-shapes
 * @version v1.0.3 - 2015-05-14
 * @link http://html5beta.com/apps/canvas-shapes.html
 * @author ZHAO Xudong (zxdong@gmail.com)
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
!function(t){function o(t,o){var e={shapeCount:20,timer:100,step:3,minSize:50,maxSize:150},r=this,i=$(t);$.extend(r,{wrap:i,ctx:i[0].getContext("2d"),width:i.width(),height:i.height(),timerHandle:!1,shapes:[],methodsPool:["star"],opts:$.extend(e,o),actionCount:0})}o.prototype.start=function(t){this.buildShapes(t),this.animate()},o.prototype.animate=function(){this.loop()},o.prototype.renderShapes=function(){var t=this,o=t.shapes;t.clearShapes();for(var e=0,r=o.length;r>e;e++){var i=o[e],a=i.type;t["draw_"+a](i)}},o.prototype.loop=function(){var t=this;this.renderShapes(),this.move(),this.timerHandle=setTimeout(function(){t.loop()},this.opts.timer)},o.prototype.move=function(){for(var t=this,o=t.shapes,e=t.opts.step,r=[],i=0,a=o.length;a>i;i++){var h=o[i],e=(h.directionY/h.directionX,t.opts.step),n=h.r,l=h.x+h.directionX*e,s=h.y+h.directionY*e,d=l>h.r?l-(t.width-h.r):h.r-l,p=s>h.r?s-(t.height-h.r):h.r-s,c=0,f=0;d>0&&p>0?d>p?(s=s>h.r?t.height-h.r:n,f=s-h.y,c=f/h.directionY*h.directionX,l=h.x+c,h.directionY=-h.directionY):(l=l>h.r?t.width-h.r:n,c=l-h.x,f=c/h.directionX*h.directionY,s=h.y+f,h.directionX=-h.directionX):d>0?(l=l>h.r?t.width-h.r:n,c=l-h.x,f=c/h.directionX*h.directionY,s=h.y+f,h.directionX=-h.directionX):p>0&&(s=s>h.r?t.height-h.r:n,f=s-h.y,c=f/h.directionY*h.directionX,l=h.x+c,h.directionY=-h.directionY),h.x=l,h.y=s,r.push(h)}t.shapes=r},o.prototype.buildShapes=function(t,o){for(var e,r=this,i=t||r.opts.shapeCount,a=o||r.methodsPool,h=a.length,n=0;i>n;n++)e=Math.floor(Math.random()*h),r.shapes.push(r.buildShape(a[e]))},o.prototype.buildShape=function(t){return this["build_shape_"+t]()},o.prototype.popShape=function(t){var o=this.shapes.length,e=t>o?o:t;e=o-e,this.shapes=this.shapes.slice(0,e),this.opts.shapeCount=this.opts.shapeCount-t},o.prototype.pushShape=function(t,o){var e=this,r=o||e.methodsPool,i=r.length,a=Math.floor(Math.random()*i);e.shapes.push($.extend(e.buildShape(r[a]),t)),this.opts.shapeCount++},o.prototype.stop=function(){clearTimeout(this.timerHandle),this.clearShapes()},o.prototype.clearShapes=function(){this.ctx.clearRect(0,0,this.width,this.height)},o.prototype.build_shape_bubble=function(){var t=this,o=t.opts,e=Math.floor(Math.random()*(o.maxSize-o.minSize))+o.minSize,r=2*e,i=t.width>r?t.width:r+1,a=t.height>r?t.height:r+1,h=e+Math.floor(Math.random()*(i-r)),n=e+Math.floor(Math.random()*(a-r)),l=(Math.floor(7*Math.random())-3)/3,s=(Math.floor(7*Math.random())-3)/3,d=["rgba(156,183,52,.25)","rgba(227,163,26,.25)","rgba(217,84,56,.25)","rgba(4,80,150,.25)","rgba(122,24,105,.25)"],p=d.length,c=Math.floor(Math.random()*p),f={x:h,y:n,r:e,directionX:l,directionY:s,type:"bubble",fillStyle:d[c]};return f},o.prototype.draw_bubble=function(t){var o=this.ctx;o.beginPath(),o.fillStyle=t.fillStyle,o.arc(t.x,t.y,t.r,0,2*Math.PI,!0),o.fill(),o.closePath()},o.prototype.draw_balloon=function(t){var o=this.ctx;o.beginPath(),o.fillStyle=t.fillStyle,o.arc(t.x,t.y,t.r,0,2*Math.PI,!0),o.fill(),o.closePath(),o.beginPath(),o.moveTo(this.width/2,this.height-20),o.lineTo(t.x,t.y),o.strokeStyle=t.strokeStyle,o.stroke(),o.closePath()},o.prototype.build_shape_balloon=function(){var t=this,o=t.opts,e=Math.floor(Math.random()*(o.maxSize-o.minSize))+o.minSize,r=2*e,i=t.width>r?t.width:r+1,a=t.height>r?t.height:r+1,h=e+Math.floor(Math.random()*(i-r)),n=e+Math.floor(Math.random()*(a-r)),l=(Math.floor(7*Math.random())-3)/3,s=(Math.floor(7*Math.random())-3)/3,d=["rgba(156,183,52,.25)","rgba(227,163,26,.25)","rgba(217,84,56,.25)","rgba(4,80,150,.25)","rgba(122,24,105,.25)"],p=d.length,c=Math.floor(Math.random()*p),f={x:h,y:n,r:e,directionX:l,directionY:s,type:"balloon",strokeStyle:d[c],fillStyle:d[c]};return f},o.prototype.draw_light=function(t){var o=this.ctx;o.beginPath(),o.moveTo(20,20),o.lineTo(t.x,t.y),o.strokeStyle=t.strokeStyle,o.stroke(),o.closePath()},o.prototype.build_shape_light=function(){var t=this,o=t.opts,e=Math.floor(Math.random()*(o.maxSize-o.minSize))+o.minSize,r=2*e,i=t.width>r?t.width:r+1,a=t.height>r?t.height:r+1,h=e+Math.floor(Math.random()*(i-r)),n=e+Math.floor(Math.random()*(a-r)),l=(Math.floor(7*Math.random())-3)/3,s=(Math.floor(7*Math.random())-3)/3,d=["rgba(156,183,52,.25)","rgba(227,163,26,.25)","rgba(217,84,56,.25)","rgba(4,80,150,.25)","rgba(122,24,105,.25)"],p=d.length,c=Math.floor(Math.random()*p),f={x:h,y:n,r:e,directionX:l,directionY:s,type:"light",strokeStyle:d[c]};return f},o.prototype.build_shape_heart=function(){var t=this,o=t.opts,e=Math.floor(Math.random()*(o.maxSize-o.minSize))+o.minSize,r=2*e,i=t.width>r?t.width:r+1,a=t.height>r?t.height:r+1,h=e+Math.floor(Math.random()*(i-r)),n=e+Math.floor(Math.random()*(a-r)),l=2*Math.random()-1,s=2*Math.random()-1,d={x:h,y:n,r:e,directionX:l,directionY:s,type:"heart",fillStyle:"rgba(207,13,31,.25)"};return d},o.prototype.draw_heart=function(t){var o=this,e=o.ctx,r=t.r/75,i=t.x,a=t.y,h=i-t.r,n=a-t.r;e.beginPath(),e.fillStyle=t.fillStyle,e.moveTo(h+75*r,n+40*r),e.bezierCurveTo(h+75*r,n+37*r,h+70*r,n+25*r,h+50*r,n+25*r),e.bezierCurveTo(h+20*r,n+25*r,h+20*r,n+62.5*r,h+20*r,n+62.5*r),e.bezierCurveTo(h+20*r,n+80*r,h+40*r,n+102*r,h+75*r,n+120*r),e.bezierCurveTo(h+110*r,n+102*r,h+130*r,n+80*r,h+130*r,n+62.5*r),e.bezierCurveTo(h+130*r,n+62.5*r,h+130*r,n+25*r,h+100*r,n+25*r),e.bezierCurveTo(h+85*r,n+25*r,h+75*r,n+37*r,h+75*r,n+40*r),e.fill(),e.closePath()},o.prototype.build_shape_star=function(){var t=this,o=t.opts,e=Math.floor(Math.random()*(o.maxSize-o.minSize))+o.minSize,r=2*e,i=t.width>r?t.width:r+1,a=t.height>r?t.height:r+1,h=e+Math.floor(Math.random()*(i-r)),n=e+Math.floor(Math.random()*(a-r)),l=2*Math.random()-1,s=2*Math.random()-1,d=5+Math.floor(5*Math.random()),p=["rgba(156,183,52,.25)","rgba(227,163,26,.25)","rgba(217,84,56,.25)","rgba(4,80,150,.25)","rgba(122,24,105,.25)"],c=p.length,f=Math.floor(Math.random()*c),m={x:h,y:n,r:e,outerR:e,innerR:e/2,spike:d,directionX:l,directionY:s,type:"star"};return 5===d?m.fillStyle="rgba(207,13,31,.25)":m.strokeStyle=p[f],m},o.prototype.draw_star=function(t){var o,e,r=Math.PI/2*3,a=t.x,h=t.y,n=t.spike,l=Math.PI/n,s=this,d=s.ctx,p=t.outerR,c=t.innerR;for(t.strokeStyle?d.strokeStyle=t.strokeStyle:d.fillStyle=t.fillStyle,d.beginPath(),d.moveTo(a,h-p),i=0;i<n;i++)o=a+Math.cos(r)*p,e=h+Math.sin(r)*p,d.lineTo(o,e),r+=l,o=a+Math.cos(r)*c,e=h+Math.sin(r)*c,d.lineTo(o,e),r+=l;d.lineTo(a,h-p),t.strokeStyle?d.stroke():d.fill(),d.closePath()},t.Shapes=o}(window,document);